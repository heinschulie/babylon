import{a as t,f as _,t as g,c as W}from"../chunks/1f615a2c.js";import{p as Ue,t as $,a as Ve,i as e,o as X,c as u,s as i,r as c,f as w,n as x,l as a,m as N}from"../chunks/8b0cb860.js";import{s as y}from"../chunks/63f41f2c.js";import{i as D,b as Ye}from"../chunks/c17651b9.js";import{e as qe}from"../chunks/62e4c738.js";import{c as P}from"../chunks/c1381360.js";import{r as Ge,s as He,a as Ce}from"../chunks/31bcfbfc.js";import{p as Je}from"../chunks/72de938e.js";import{a as ie}from"../chunks/fb331d7f.js";import{B as V}from"../chunks/d6fb44ac.js";import{C as We}from"../chunks/0eebc8ab.js";import{C as Xe,a as Ze,b as et}from"../chunks/34ef69f1.js";import{D as tt,a as rt,b as at,c as st,d as ot,e as it,f as nt}from"../chunks/8488c4d0.js";import{L as we,I as De}from"../chunks/4e497c6c.js";import{u as lt,a as dt}from"../chunks/b1448760.js";var vt=_('<p class="meta-text"> </p>'),ut=_("<!> <!>",1),ct=_('<p class="mt-1 text-xs text-muted-foreground"> </p>'),ft=_('<div class="mt-3 flex gap-2"><!> <!></div>'),gt=_("<div><p> </p> <!> <!></div>"),pt=_('<p class="text-sm text-destructive"> </p>'),_t=_("<!> <!> <!>",1),mt=_('<!> <div class="space-y-4 py-4"><div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div> <!> <!></div> <!>',1),ht=_("<!> <!>",1),$t=_('<p class="text-muted-foreground">Loading phrases...</p>'),xt=_('<p class="text-destructive"> </p>'),yt=_('<p class="text-muted-foreground">No phrases yet. Add your first phrase!</p>'),bt=_("<div><!> <!></div> <!>",1),Pt=_('<div class="page-shell page-shell--narrow page-stack"><div class="flex flex-wrap items-start justify-between gap-3"><div><a class="meta-text underline">&larr; Back to sessions</a> <h1 class="mt-2 text-5xl sm:text-6xl"><!></h1> <!></div> <!></div> <div><h2 class="text-4xl sm:text-5xl">Phrases</h2></div> <div class="space-y-4"><!></div></div>');function Ot(Ee,Le){Ue(Le,!0);const ne=lt(),xe=X(()=>Je.params.id),q=dt(ie.phrases.listBySession,()=>({sessionId:e(xe)})),E=X(()=>q.data?.session),le=X(()=>q.data?.phrases);let Z=N(!1),L=N(""),k=N(""),ee=N(!1),te=N(!1),C=N(""),p=N(null),Y=N(!1);async function Se(){if(!e(L).trim()||!e(k).trim()){a(C,"Please enter both English and translation");return}if(!e(E)?.targetLanguage){a(C,"Session language not found");return}a(te,!0),a(C,""),a(p,null);try{const r=await ne.action(ie.translateNode.verifyTranslation,{english:e(L).trim(),userTranslation:e(k).trim(),targetLanguage:e(E).targetLanguageCode??e(E).targetLanguage});a(p,r,!0),a(Y,!0)}catch(r){a(C,r instanceof Error?r.message:"Failed to verify translation",!0)}finally{a(te,!1)}}async function Te(){if(!e(L).trim()||!e(k).trim()){a(C,"Please enter both English and translation");return}a(ee,!0),a(C,"");try{await ne.mutation(ie.phrases.create,{sessionId:e(xe),english:e(L).trim(),translation:e(k).trim()}),a(Z,!1),ye()}catch(r){a(C,r instanceof Error?r.message:"Failed to create phrase",!0)}finally{a(ee,!1)}}function Ae(){e(p)?.suggestedTranslation&&(a(k,e(p).suggestedTranslation,!0),a(Y,!1),a(p,null))}function Ie(){a(Y,!1)}function ye(){a(L,""),a(k,""),a(p,null),a(Y,!1),a(C,"")}async function Be(r){if(confirm("Are you sure you want to delete this phrase?"))try{await ne.mutation(ie.phrases.remove,{id:r})}catch(d){console.error("Failed to delete phrase:",d)}}var de=Pt(),ve=u(de),ue=u(ve),be=u(ue),ce=i(be,2),Fe=u(ce);{var ze=r=>{var d=g();$(()=>y(d,`${e(E).targetLanguage??""} Session`)),t(r,d)},Ne=r=>{var d=g("Session Details");t(r,d)};D(Fe,r=>{e(E)?r(ze):r(Ne,!1)})}c(ce);var je=i(ce,2);{var Oe=r=>{var d=vt(),j=u(d,!0);c(d),$(()=>y(j,e(E).date)),t(r,d)};D(je,r=>{e(E)&&r(Oe)})}c(ue);var Ke=i(ue,2);P(Ke,()=>nt,(r,d)=>{d(r,{get open(){return e(Z)},set open(j){a(Z,j,!0)},children:(j,ke)=>{var re=ht(),S=w(re);{const O=(K,M)=>{V(K,Ye(()=>M?.().props,{children:(T,G)=>{x();var A=g("Add Phrase");t(T,A)},$$slots:{default:!0}}))};P(S,()=>tt,(K,M)=>{M(K,{child:O,$$slots:{child:!0}})})}var B=i(S,2);P(B,()=>rt,(O,K)=>{K(O,{children:(M,F)=>{var T=mt(),G=w(T);P(G,()=>at,(o,f)=>{f(o,{children:(n,R)=>{var b=ut(),I=w(b);P(I,()=>st,(m,l)=>{l(m,{children:(s,h)=>{x();var v=g("Add New Phrase");t(s,v)},$$slots:{default:!0}})});var z=i(I,2);P(z,()=>ot,(m,l)=>{l(m,{children:(s,h)=>{x();var v=g();$(()=>y(v,`Enter an English phrase and your ${(e(E)?.targetLanguage||"target language")??""} translation.`)),t(s,v)},$$slots:{default:!0}})}),t(n,b)},$$slots:{default:!0}})});var A=i(G,2),Q=u(A),H=u(Q);we(H,{for:"english",children:(o,f)=>{x();var n=g("English");t(o,n)},$$slots:{default:!0}});var fe=i(H,2);De(fe,{id:"english",placeholder:"Enter English phrase",get value(){return e(L)},set value(o){a(L,o,!0)}}),c(Q);var J=i(Q,2),ae=u(J);we(ae,{for:"translation",children:(o,f)=>{x();var n=g();$(()=>y(n,`Your Translation (${(e(E)?.targetLanguage||"target")??""})`)),t(o,n)},$$slots:{default:!0}});var ge=i(ae,2);De(ge,{id:"translation",placeholder:"Enter your translation",get value(){return e(k)},set value(o){a(k,o,!0)}}),c(J);var pe=i(J,2);{var se=o=>{var f=gt(),n=u(f),R=u(n,!0);c(n);var b=i(n,2);{var I=l=>{var s=ct(),h=u(s);c(s),$(()=>y(h,`Similarity: ${e(p).similarity??""}%`)),t(l,s)};D(b,l=>{e(p).similarity!==void 0&&l(I)})}var z=i(b,2);{var m=l=>{var s=ft(),h=u(s);V(h,{size:"sm",variant:"outline",onclick:Ae,children:(U,oe)=>{x();var $e=g("Use Suggestion");t(U,$e)},$$slots:{default:!0}});var v=i(h,2);V(v,{size:"sm",variant:"ghost",onclick:Ie,children:(U,oe)=>{x();var $e=g("Keep Mine");t(U,$e)},$$slots:{default:!0}}),c(s),t(l,s)};D(z,l=>{!e(p).verified&&e(p).suggestedTranslation&&l(m)})}c(f),$(()=>{Ce(f,1,`rounded-lg border p-4 ${e(p).verified?"border-green-500 bg-green-50 dark:bg-green-950":"border-orange-500 bg-orange-50 dark:bg-orange-950"}`),Ce(n,1,`text-sm font-medium ${e(p).verified?"text-green-700 dark:text-green-300":"text-orange-700 dark:text-orange-300"}`),y(R,e(p).message)}),t(o,f)};D(pe,o=>{e(Y)&&e(p)&&o(se)})}var _e=i(pe,2);{var me=o=>{var f=pt(),n=u(f,!0);c(f),$(()=>y(n,e(C))),t(o,f)};D(_e,o=>{e(C)&&o(me)})}c(A);var he=i(A,2);P(he,()=>it,(o,f)=>{f(o,{children:(n,R)=>{var b=_t(),I=w(b);V(I,{variant:"outline",onclick:()=>{a(Z,!1),ye()},children:(s,h)=>{x();var v=g("Cancel");t(s,v)},$$slots:{default:!0}});var z=i(I,2);{var m=s=>{{let h=X(()=>e(te)||!e(L).trim()||!e(k).trim());V(s,{variant:"secondary",onclick:Se,get disabled(){return e(h)},children:(v,U)=>{x();var oe=g();$(()=>y(oe,e(te)?"Checking...":"Check Spelling")),t(v,oe)},$$slots:{default:!0}})}};D(z,s=>{e(Y)||s(m)})}var l=i(z,2);{let s=X(()=>e(ee)||!e(L).trim()||!e(k).trim());V(l,{onclick:Te,get disabled(){return e(s)},children:(h,v)=>{x();var U=g();$(()=>y(U,e(ee)?"Adding...":"Add Phrase")),t(h,U)},$$slots:{default:!0}})}t(n,b)},$$slots:{default:!0}})}),t(M,T)},$$slots:{default:!0}})}),t(j,re)},$$slots:{default:!0}})}),c(ve);var Pe=i(ve,4),Me=u(Pe);{var Qe=r=>{var d=$t();t(r,d)},Re=r=>{var d=W(),j=w(d);{var ke=S=>{var B=xt(),O=u(B);c(B),$(()=>y(O,`Error loading phrases: ${q.error.message??""}`)),t(S,B)},re=S=>{var B=W(),O=w(B);{var K=F=>{var T=yt();t(F,T)},M=F=>{var T=W(),G=w(T);qe(G,17,()=>e(le),A=>A._id,(A,Q)=>{var H=W(),fe=w(H);P(fe,()=>We,(J,ae)=>{ae(J,{class:"border border-border/60 bg-background/85 backdrop-blur-sm",children:(ge,pe)=>{var se=W(),_e=w(se);P(_e,()=>Xe,(me,he)=>{he(me,{class:"flex flex-row items-start justify-between gap-3",children:(o,f)=>{var n=bt(),R=w(n),b=u(R);P(b,()=>Ze,(m,l)=>{l(m,{children:(s,h)=>{x();var v=g();$(()=>y(v,e(Q).english)),t(s,v)},$$slots:{default:!0}})});var I=i(b,2);P(I,()=>et,(m,l)=>{l(m,{class:"text-primary",children:(s,h)=>{x();var v=g();$(()=>y(v,e(Q).translation)),t(s,v)},$$slots:{default:!0}})}),c(R);var z=i(R,2);V(z,{variant:"ghost",size:"sm",class:"text-destructive hover:text-destructive",onclick:()=>Be(e(Q)._id),children:(m,l)=>{x();var s=g("Delete");t(m,s)},$$slots:{default:!0}}),t(o,n)},$$slots:{default:!0}})}),t(ge,se)},$$slots:{default:!0}})}),t(A,H)}),t(F,T)};D(O,F=>{!e(le)||e(le).length===0?F(K):F(M,!1)},!0)}t(S,B)};D(j,S=>{q.error?S(ke):S(re,!1)},!0)}t(r,d)};D(Me,r=>{q.isLoading?r(Qe):r(Re,!1)})}c(Pe),c(de),$(r=>He(be,"href",r),[()=>Ge("/")]),t(Ee,de),Ve()}export{Ot as component};
